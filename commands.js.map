{"version":3,"file":"commands.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/./src/commands/commands.js"],"sourcesContent":["/* global Office */\n\n// Global variable for email data\nlet emailData = {};\nlet item;\n\n// Initialize Office add-in\nOffice.onReady(() => {\n  item = Office.context.mailbox.item;\n});\n\n/**\n * Get email data and prepare default values for a new email.\n * @param {Office.AddinCommands.Event} event\n */\n\nconst baseURL = \"http://www.centreblock.org/\";\n\nfunction GetDefault(event) {\n  // Extract email fields\n  const receiver = item.to ? item.to.map(recipient => recipient.emailAddress).join(\", \") : \"\";\n  const sender = item.from ? item.from.emailAddress : \"\";\n  const subject = item.subject || \"No subject\";\n  const ccList = item.cc ? item.cc.map(cc => cc.emailAddress) : [];\n\n  // Format email timestamp\n  const emailTimestamp = formatEmailTimestamp(item.dateTimeCreated);\n\n  // Construct emailData object\n  emailData = {\n    htmlBody: \"\",\n    campaign: receiver ? [receiver] : [],\n    source: sender,\n    medium: emailTimestamp,\n    content: subject,\n    term: ccList,\n  };\n\n  // Generate UTM URL and add it to email body\n  const UTM_URL = generateURLFromEmailData(emailData);\n  emailData.htmlBody = UTM_URL;\n\n  // Display a new email form with the prepared data\n  Office.context.mailbox.displayNewMessageForm({\n    toRecipients: emailData.campaign,\n    ccRecipients: ccList.map(email => ({ emailAddress: email })),\n    subject: subject,\n    // htmlBody: `<a href=\"${UTM_URL}\" target=\"_blank\">${baseURL}</a>`,\n  });\n\n  event.completed();\n}\n\n/**\n * Format email timestamp into a specific format.\n * @param {string} emailTimestamp\n * @returns {string} Formatted timestamp\n */\nfunction formatEmailTimestamp(emailTimestamp) {\n  const timestamp = new Date(emailTimestamp);\n  const day = String(timestamp.getDate()).padStart(2, \"0\");\n  const month = String(timestamp.getMonth() + 1).padStart(2, \"0\");\n  const year = String(timestamp.getFullYear()).slice(-2);\n  const hours = String(timestamp.getHours()).padStart(2, \"0\");\n  const minutes = String(timestamp.getMinutes()).padStart(2, \"0\");\n\n  return `${day}-${month}-${year}_${hours}.${minutes}`;\n}\n\n/**\n * Generate a UTM URL using email data.\n * @param {Object} emailData\n * @returns {string} Generated UTM URL\n */\nfunction generateURLFromEmailData(emailData) {\n  // Construct UTM parameters from emailData\n  const utmParams = {\n    utm_campaign: emailData.campaign + \"+to\" || \"default_campaign\",\n    utm_source: emailData.source + \"+from\" || \"default_source\",\n    utm_medium: emailData.medium || \"default_medium\",\n    utm_content: emailData.content || \"default_content\",\n    utm_term: emailData.term || \"default_term\",\n  };\n\n  const url = new URL(baseURL);\n  Object.keys(utmParams).forEach(key => {\n    url.searchParams.append(key, utmParams[key]);\n  });\n\n  return decodeURIComponent(url.toString());\n}\n\n// Register the functions with Office actions\nOffice.actions.associate(\"GetDefault\", GetDefault);\n\n\n// Helper function to format the current date and time\nfunction getCurrentDateTime() {\n  const now = new Date();\n  const year = now.getFullYear().toString().slice(-2); // Last two digits of the year\n  const month = (now.getMonth() + 1).toString().padStart(2, \"0\");\n  const day = now.getDate().toString().padStart(2, \"0\");\n  const hours = now.getHours().toString().padStart(2, \"0\");\n  const minutes = now.getMinutes().toString().padStart(2, \"0\");\n  return `${day}-${month}-${year}_${hours}.${minutes}`;\n}\n// Perform functionality when a new message is composed\nasync function SetDefaultData(event) {\n  try {\n    // Get the \"To\" recipients\n    const toRecipients = await new Promise((resolve, reject) => {\n      item.to.getAsync((result) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          resolve(result.value);\n        } else {\n          reject(result.error);\n        }\n      });\n    });\n\n    // Get the \"CC\" recipients\n    const ccRecipients = await new Promise((resolve, reject) => {\n      item.cc.getAsync((result) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          resolve(result.value);\n        } else {\n          reject(result.error);\n        }\n      });\n    });\n\n    // Get the email subject\n    const subject = await new Promise((resolve, reject) => {\n      item.subject.getAsync((result) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          resolve(result.value);\n        } else {\n          reject(result.error);\n        }\n      });\n    });\n\n    // Extract recipient addresses\n    const toAddresses = toRecipients.map((recipient) => recipient.emailAddress).join(\", \");\n    const ccAddresses = ccRecipients.length > 0\n      ? ccRecipients.map((recipient) => recipient.emailAddress).join(\", \")\n      : \"blank\";\n\n    const medium = (`e-mail_${getCurrentDateTime()}`).replace(/ /g, \"_\");\n\n    let utmCampaign = toAddresses.replace(/ /g, \"_\");\n    let utmSource = Office.context.mailbox.userProfile.emailAddress.replace(/ /g, \"_\");\n    let utmMedium = medium.replace(/ /g, \"_\");\n    let utmContent = subject.replace(/ /g, \"_\");\n    let utmTerm = ccAddresses.replace(/ /g, \"_\");\n\n    const queryString = `?utm_campaign=${utmCampaign}&utm_source=${utmSource}&utm_medium=${utmMedium}&utm_content=${utmContent}&utm_term=${utmTerm}`;\n\n    // Combine the base URL with the query string\n    const finalUrl = baseURL + queryString;\n    console.log(finalUrl);\n    let signature;\n    let userName = Office.context.mailbox.userProfile.displayName;\n    // Get the signature HTML from localStorage\n    let signatureHtmlObj = localStorage.getItem(\"signatureHtml\");\n    if (!signatureHtmlObj) {\n      console.error(\"No signature HTML found in localStorage.\");\n      signature = `<p>${userName}</p><p><a data-fr-linked=\\\"true\\\" href=\\\"http://www.centreblock.org/\\\" id=\\\"isPasted\\\">http://www.centreblock.org/</a></p><p><img src=\\\"data:image/png;base64,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\\\" style=\\\"width: 114px;\\\" class=\\\"fr-fic fr-dib fr-fil\\\"></p><p><br></p>`;\n    } else {\n      let signaturehtmlobgparse = JSON.parse(signatureHtmlObj);\n      signature = signaturehtmlobgparse.html;\n    }\n\n    const linkHTML = `<a href=\"${finalUrl}\" target=\"_blank\">${baseURL}</a>`;\n\n\n\n    const cleanedSignature = signature.replace(\n      /<p[^>]*data-f-id=\"pbf\"[^>]*>.*?<a[^>]*href=\"https:\\/\\/www\\.froala\\.com\\/wysiwyg-editor\\?pb=1\"[^>]*>.*?<\\/a><\\/p>/g,\n      \"\"\n    );\n    // Replace only the href in the a tag with finalUrl\n    const updatedSignature = cleanedSignature.replace(/<a[^>]*>.*?<\\/a>/g, linkHTML);\n\n    console.log(\"Updated Signature HTML:\", updatedSignature);\n\n    // Use setSignatureAsync to update the email signature\n    Office.context.mailbox.item.body.setSignatureAsync(\n      updatedSignature,\n      { coercionType: \"html\" },\n      function (asyncResult) {\n        if (asyncResult.status === Office.AsyncResultStatus.Succeeded) {\n          console.log(\"setSignatureAsync succeeded\");\n          event.completed();\n        } else {\n          console.error(asyncResult.error);\n          event.completed();\n        }\n      }\n    );\n\n  } catch (error) {\n    console.error(\"Error populating UTM defaults:\", error);\n    event.completed();\n  }\n  event.completed();\n}\n// Register the functions with Office actions.\nOffice.actions.associate(\"SetDefaultData\", SetDefaultData);"],"names":["_regeneratorRuntime","e","t","r","Object","prototype","n","hasOwnProperty","o","defineProperty","value","i","Symbol","a","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","call","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","p","d","getPrototypeOf","v","values","g","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","Error","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","return","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","length","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","slice","stop","rval","handle","complete","finish","catch","delegateYield","asyncGeneratorStep","item","emailData","Office","onReady","context","mailbox","baseURL","_SetDefaultData","_callee","event","toRecipients","ccRecipients","subject","toAddresses","ccAddresses","medium","utmCampaign","utmSource","utmMedium","utmContent","utmTerm","queryString","finalUrl","signature","userName","signatureHtmlObj","signaturehtmlobgparse","linkHTML","cleanedSignature","updatedSignature","_context","reject","to","getAsync","result","status","AsyncResultStatus","Succeeded","error","cc","map","recipient","emailAddress","join","concat","now","year","month","day","hours","minutes","Date","getFullYear","toString","getMonth","padStart","getDate","getHours","getMinutes","replace","userProfile","console","log","localStorage","getItem","JSON","parse","html","body","setSignatureAsync","coercionType","asyncResult","completed","t0","arguments","apply","_next","_throw","actions","associate","receiver","sender","from","ccList","emailTimestamp","timestamp","String","formatEmailTimestamp","dateTimeCreated","UTM_URL","utmParams","utm_campaign","campaign","utm_source","source","utm_medium","utm_content","content","utm_term","term","url","URL","key","searchParams","append","decodeURIComponent","generateURLFromEmailData","htmlBody","displayNewMessageForm","email","_x"],"sourceRoot":""}